# haj-in-the-middle

[library.m0unt41n.ch/challenges/haj-in-the-middle](https://library.m0unt41n.ch/challenges/haj-in-the-middle) ![](../../resources/forensics.svg) ![](../../resources/baby.svg) 

# TL;DR

We get a pcap file, which is a record of a short FTP session. The interesting part:

```
49	9.600663	192.168.1.120	192.168.1.121	FTP	85	Request: STOR Secrets.kdbx
50	9.601518	192.168.1.121	192.168.1.120	FTP	124	Response: 150 Opening BINARY mode data connection for Secrets.kdbx
51	9.602056	192.168.1.120	192.168.1.121	FTP-DATA	2135	FTP Data: 2069 bytes (EPASV) (STOR Secrets.kdbx)
```

Copying the hex payload from that `STOR` into [CyberChef](https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')&input=MDNkOWEyOWE2N2ZiNGJiNTAwMDAwNDAwMDIxMDAwMDAwMDMxYzFmMmU2YmY3MTQzNTBiZTU4MDUyMTZhZmM1YWZmMDMwNDAwMDAwMDAxMDAwMDAwMDQyMDAwMDAwMGViNjI4NGIzMjEzZDJmMGViMTdlYTgxZDZkMWIwM2RmNTNiMDM3Y2IyNmUzYzAxYTFkYjY5NGVjMTdhYmFkYWUwNzEwMDAwMDAwMTFjZGQzMzliYjQ5MTNlOTc0ZDllZGZiZTUwNDZhYzcwYjhiMDAwMDAwMDAwMTQyMDUwMDAwMDAyNDU1NTU0OTQ0MTAwMDAwMDBlZjYzNmRkZjhjMjk0NDRiOTFmN2E5YTQwM2UzMGEwYzA1MDEwMDAwMDA0OTA4MDAwMDAwOWYwMDAwMDAwMDAwMDAwMDA1MDEwMDAwMDA0ZDA4MDAwMDAwMDAwMDAwMDQwMDAwMDAwMDA0MDEwMDAwMDA1MDA0MDAwMDAwMTAwMDAwMDA0MjAxMDAwMDAwNTMyMDAwMDAwMDExNWU1MmZlMmE1Y2E4YmQyODI3MWM2NDRhYzJkMmJkNWI0N2VjNDRlZWM0NWRjZjQ2ZWVlYTAwMmFiZGQwN2QwNDAxMDAwMDAwNTYwNDAwMDAwMDEzMDAwMDAwMDAwMDA0MDAwMDAwMGQwYTBkMGFiNTU0NGU4MTFjNDhlZGQ0NzNhNDBkNDAyZjE5YTBkZTI0MTc5ZTY4ZTRmZmQzODI3NDYyYTBhYTk3NzA5ZjY3ZjBlZTY0OTMxNmE0OGRhYWNmN2ZiNzAyZDI0YTI0NzFiMjJmYTYwNTEwMjY1MjIxYmU1Y2E1OTY1OGQwMjNiOTgwMDJlNTcxOWZhMDRlMDc1NGY5MDc5ZTllYTZlNTEwMDU1NTAzOTc1ODk4Yjc4NzRmYTUxYjdiZjk0OTYzMDk5MDA2MDAwMGMzZGZhZjhlZGVlZTc3ZmRkZTFmYTMwYzI2YzM3MTZjZGM0NjVmMWQwMGEwYTM4M2VkODM2NDQ3NDdjNTdjZTJlNmYzNTUwN2IxZDZiYzRmMjBjODk3MTQ0MGZmZWM0MjVkMTg3OGFmYTBlN2EwYTgzN2Y1NGRlZmQ2YmVhNWJkYmFlNTMyN2VmNWY1MmRiZDA5OWI1NjJlNDNlZDU0MGRhYzc1OTNmZWE1Mjg2MDQ0MGMyODJlMzc3YmQzOTc4ZDcwYWU4ZTM4M2Y1MzllNjkwMjRjY2U5NjQ3YTc4MTg5Zjk4ZDUxZWQ0ZDVkZDc4ZDdjODZmOWUxZTQ5OTVkODk5MTBmNzc0MmM1ZmM0MjNjZjFkZjA0NDQyMDVhODIyYTNkNDA2M2VkNmZmYzc3NzFlY2EwM2E4ZTk2OTZiZGM1OTFiZGEwMTVmMzg2MGNkZTgxYzA5NGM2MWU3NjMwNjI4ZThiNzU1YzEwYzQ0NTQzN2FjNDRjODFiOGQyNGU2OGJlYTNhYWFhNTFkZDQ2OWJmZGFiMDc0YmZiY2VjODlkNGRmOWZmMmNkZGJhYWMxYzQ5MDZlMTllMGVhNzc4NDNhMjJjYzY3Y2E1OWUzZTU4MzlkMDcyY2ZiMzA4MDBjZTQ5YWY4ZTc3Y2U2ZjEzNmU0OTI4NDcyYWVhNmVmYzMwMGViMzBmYzJkYTg5NzFiOGEwMTI4NGY1OGQ1M2Y0NWY5NDhlM2I4Y2VlZTc0ZTQ4MGNjZGVjYTUwYTE1ZTg1Nzg1YTBlY2MyNWI0MjQ3M2E2MzRlOTU4ZDU3M2Y4MzJkZDQwMGE5NDk0MTE4MDVjMjQ2MzExYWJiMmViNGIzOTZjM2ZlYTU1M2RiYmE1ZmU5ZjMzZjIzOWY5ZDFhMTEyNWYwNDhmY2YxYjEzZjJmMWJlMTJkNjQ0MWU3ZDEzY2UyYjA2Y2NmODdjNWNhNWZmN2Y2ZWRjMGVhZmQ5M2FiMWRmZGE2MzU0YTQ5ZGVjYjBmYWVkZmEzYzU5Njg1MTFlMmZkNzhjOTM4ZjU0ZmVmNmVjNjQ4ZTgzNzc1YjQwOWMyZDExYmQxYmUxMjY0ODQ1ZGFkMThhYjVkZjgyZDMzNTA4ZGJjOGIxOWRmODU0OWUxODBhYjVhOTc5OWU2MjljMDc4MzhhM2ZhYWFhYWZhYmViYjRmOWJlNmY0NGFhNzM2NTllODE5NDRiYTdlZDJlMGEwNTFlNjYzZTY1ZGZkNDIyOGMyNmZhYmNlYmM3YTQ1NjI5NjZlYjRiZDczYmZkYzZjNGNkNGIzYTViZDk1ZjU0OTRiMTc0YWFlOWNkMjJmMjM3MTdlMzBjYTlmMDNlNWE0NTkzNDUzMzYwOWFjYjUzZGU1ZWYwNjE5M2FiNGM2MGFmMWZiYTgyOTE4NTg3ZDhhYzM0YTBkZTdmZDZlZWRhY2I0MjhhNmZmMTQzYTA1NWFiMTgyMGYyNDk0NTUzMzkwOTgxOTNhZjY0MjMxOTNhZjZkOTBiOWY1ZGU5ODQxNzAwOTgxZDUzMmU1YTY2ZTcxNjJmODk3NmIwNGI0MjJiYzdmMWQ3MDEyYzZjN2ZiNzZiYTFjMDBjMDQ2NGQ2YmJjNzRmNTM1MmI4MzBiMGY0YWQ0MjY1YzljZTg2ODY2ZmFhNTljYjhiZDEzZTAyZTQyMDE2NmYyMTRmYWEwOGM2ZTdmOTQ1ZDY2NjU0ZDgyNDg2OGE2YmZkY2VkMmYzMGUyODBmM2JkZWRkMjhlZDNiYTBhZGIzYTVjNmE4M2RkMGM0YThkZmRjZTNhMWE2OGQxNjNhYzQ0MTBmYWUwYjM4NWFhNmNhN2IyMzRiMDA4MTAzNjk0NDU3OTExMmMzMDlmN2UwZGNiMmYyZDA4NjAwNTI1YzY1ZmM5MGYyMGM2OWIzNGVlMzUxNTQ5YWRiODQ3MmNlYzJhMTU4NTEzMDVjMjY5OGUyZThkOWM0NGZkYTAyY2NhMGQ1NzdmODlkMzFlYzhmY2NjOTI2ZjhlNDk0N2M0MzcwYjQyNTIyOTViNDE4ZjE1OTdkNWNkM2EwYTczYjc5MWE1N2VhMTE3NDAwNzI0ZmJhNjczNjYwZjNkZjFmYTY0Y2M5YTdkMTU5OTk3YmQ0OWUyNDE5OTFkZjZmNWQ2Y2FlNTU2ZjljNmIxNzBjZWYxZGE1ZDhhZWJkNDUwOGRjZTliMDFiYTYwMWZmMzYzZTU4YmNkODhkZWFkNDU2NjNiYzU3MWZkMTVhMjkyYTMxZjM0YzRjYTU4ZWUxNzA4MDg1ZmYzZjFhOTkzMmViNTc3OTczNjc0YjViMGYyMTdhYTdkZjYwN2FjZDQwYTRkZTMxYmU0NmQ1NjhhN2U4NjI3ZjA4ZDI5Y2NlYWJhZDQ5ZTg4ZTJmOGM5YThmZjUwN2I0NDJhMGM1ZDg2NDVkNzI5OTRiNzkzMTI2MTMxMDNmMzJmMmI3ZDExM2EwYjljOTgyMmY5ZTg4OTMwYTU1NDIzYjk1OGZlYjMyZDcwNjVkYmFmMzU1MDU1ZWFlY2Y2NDBkNjkwN2E2N2M0ZjEzMTdiYzE4MTgzOWM5MDZiOGM5NmI4ODJiYzg3YWI5ZGMwMTcxOTIzYTQ2NzA5NmI2NGFiOWY2MzZhMWU2NzFkYzAyOTY1ZTIwMGZmMmJiM2UxZTQ5NzQ0NmU2ZDZhYTU2MTY0ZDIzZmRkYTJjMGRiOWQzNGQ3MjRkNzYxOGExNDM4NjMxMmM1YmZiZWVkMDk2ZTMzYjRjNTc4ODI1Yjg5ZTFhYjYzODgxNDk1MWU1OTkwNTg5MzUxODI1YWFmMzdhYWRjM2Y2ZTUyN2VlYzI5MzVlYzI4ZmYwNTYzY2M0MDQ5NTJiYzcxNTE1Y2I0OTc1NDNlNTY0NDY3MjJkNzNhNjdjZTkwMWE4Yzg0MzcxNmFiY2UwMTAxMTk4ZTk5ODExOTRlMzc0MWY2OGZlZTE1ZGVjMzk4MzlkNzk0N2M3NjBiYjM1YTg2NzQ3MWQwYTQ2MzdkNjU4MGNmNWI1YWEzNzhiNTgxNDlkNWY5YmE0NmM5ZDM2M2MzYjFhYjExM2E5NzY3ZTRjYmMyYzIzMGUzN2Y1YTViOGJjNWJjNDJkMDRlYWUxOGQ3NjIzMmYyYTE3ZjUyNzRkZjJhYjM3NTY0MGYwZDE5MWFiOTFhMzIyYzFjZWJjNWMzNTgyZmE1MjFkMWMzOWUzMTg2ODc4MzljMzk5YThlZmNhZDcwZGY1ZWY3OTAxZTU0NTBkOTc2MDA4NmQ3Y2ZlNmUxZDcxZDkwODczMTM3MDJkZWJkYzE1YmU5MTYzNzkyMjMyNWZkNzA4Y2RhZWVhOTlhNWM5M2YxNjIyY2JlNTM4YzZiYTI0ZGE3NTA2MzY3YzgzNmRkMWViYmVhNDFhMDQ5ZDkzODVjMzU2NzIzNDFiMGY1MDljYTZmNmE4YTU1MzQwNmUzNTZlNTE0MzY1ZTFhYmFmNTI1YjBlZTI3NzYzZTk5OWRjYjBmNDcwNzAwZGY1YzU0N2Y3ODI0ZGUzZDZjZDkzMzU1Mjg2YjczNzIzNDQ3N2Y2NTE2MGE2MmYyMmMzODlhNTFlNTM4OWUxMDM0NWMyMWViMzk5YzI2ZjA3ZDU2M2Y2OTZlZTljNTEzZDFjMWRkNjdkZjI3NGQ2ZTQxZDM2NzAwMjBkODhkZTkyNTc1OTk4YjZkNDc3OGI3ODk0MWIzODNmZmQwYTU5Yzg1YWYxMWY2YmQ5ZTU5ZDkwYjY5MjkwMDQ3YjcxM2E4ODMzZWQ1MDRmMjU2ZGVmNWJmNWRmMDIzNTNjMDJjYjQ1NjQyNTg2OTJiYTAxNDM5Zjg2Njg0ZGU0MDA4OWFmZTAzNjc1MzlhMmExMjJhMDQ0MjAwYWQ5YzVjZDNmYzBhZjkzZDA0YTljMjJhNmU1M2MyODczMmNkZDMyZjhiZjA0ZDQzNjI0OTY0YTIwOTRhZDhjMTIwZjA4MDg1MWJjZjc3OTM5M2NlMzY1MjI1NGE3ODc4MmI1MmYxNzlmMjkzNDQxYjhiMjgyMDQ3ZjcyYjFhZTQ4ZmFlY2RmZWRjYjkzMTExMzlhMjlhY2RkM2I4NTA2ODY1MjlmODJlOWUxNzY0Mzk0NzBmNGM5ZWU2ODc5OGYwNWZhMGEzMWI5NDBlNDkxZDY5YWYxODQ0MGNjY2EzNjNhYzNlYjQwZWViOTY0MTc5NjVjZWUxOGU5NDQ4MDI3OTQ2OGU5M2NhOGZmMjM5YThmNTM1NzljYjYyYmZlMDg3ODM2OWZlOTFiYTk5ODM5OWY2Y2Q3MDNhNGQ5NTY3MmJiMjhiZGEyM2FhZjE5MmM3ZTQzMWYwNTg2ZGMxNDg2NWIzMGM4MTIzOTY0MDQ2NmEwY2IwY2Y1ZjJjZGU3NTFiZDNhMzMxNWQyZGNlOTg3NDAzNDcxZGI3NjAxZWE1MDQyMWUyMzI4YWUzYmY5MjRlYmVmNTBjMGY1Y2Y2MTgyMjBjNDI3OTY4YmQ0YmQyNzFlZjVjNDA2MTNlZGEwMzk2N2NkMzkwNjAzYmI5Y2IxODQyMGJiNzYzNzgxZDI3YjRhMDA3MGQ1NzA0NTI3OTI3ZjIwMDAwMDAwMA&oeol=FF), we get:

```
$ file payload.kdbx 
payload.kdbx: Keepass password database 2.x KDBX
```

That file has a master password. But we strongly suspect it's the same as used for FTP:

```
19	5.940782	192.168.1.120	192.168.1.121	FTP	79	Request: PASS dadada
```

And indeed, that opens the vault.

---

## `SCD{sn1ff_sn1ff_sn1f}`


<hr>

&copy; [muflon77](https://library.m0unt41n.ch/players/805ae1c8-9fe4-5816-b4a4-5057fa6eedb1)
