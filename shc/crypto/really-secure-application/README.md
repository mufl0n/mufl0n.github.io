# really-secure-application

[library.m0unt41n.ch/challenges/really-secure-application](https://library.m0unt41n.ch/challenges/really-secure-application) ![](../../resources/crypto.svg) ![](../../resources/baby.svg) 

# TL;DR

We get a Python program that encrypts the flag and its output. The output has all data needed to decrypt the flag.

# Code

```python
from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytes
import random

flag = b"SCD{f4k3_fl4g}"
p = getPrime(1024)
q = 7
n = p * q
e = e = 65537
phi = (p - 1) * (q - 1)
d = inverse(e, phi)

flag_int = bytes_to_long(flag)
ciphertext = pow(flag_int, e, n)

print(f"Public modulus (n): {n}")
print(f"Public exponent (e): {e}")
print(f"Encrypted flag: {ciphertext}")

decrypt = pow(ciphertext, d, n)
# print(long_to_bytes(decrypt))
```

# Output

```
Public modulus (n): 1186029292037952909983792432306452587425266074685148559256411524118533884795954832993947356308189843827916747393770934033391200656633881903962557992375311329821223845429093776689672634207483637282457856395284891548748666784553146529707500135533133296584880911894111872112018935683414189955943902732488471774953
Public exponent (e): 65537
Encrypted flag: 733568336222790589470096969949196690400886881122508612017162580799729948344126319987475331014669434677564792251353760238087218803592587521385878004071493183548939254573853401155722047457350634791379651022516512709399603944845196902930993851922578027579933013748262257897144604228176365756268938687669643000231
```

# Getting the flag

We can pretty much copy all above code. The only difference is that we have `n` from the output but not `p` which was a random prime. So, we just need to replace `n = p * q` with `p = n // q`. And last two lines of above code give an even more direct hint.

```python
from Crypto.Util.number import inverse, long_to_bytes

n = 1186029292037952909983792432306452587425266074685148559256411524118533884795954832993947356308189843827916747393770934033391200656633881903962557992375311329821223845429093776689672634207483637282457856395284891548748666784553146529707500135533133296584880911894111872112018935683414189955943902732488471774953
ciphertext = 733568336222790589470096969949196690400886881122508612017162580799729948344126319987475331014669434677564792251353760238087218803592587521385878004071493183548939254573853401155722047457350634791379651022516512709399603944845196902930993851922578027579933013748262257897144604228176365756268938687669643000231

q = 7
p = n // q
e = 65537
phi = (p - 1) * (q - 1)
d = inverse(e, phi)
decrypt = pow(ciphertext, d, n)
print(long_to_bytes(decrypt).decode('ascii'))
```

---

## `SCD{w34k_r54_pr1m3s_1fed2fea}`


<hr>

&copy; [muflon77](https://library.m0unt41n.ch/players/805ae1c8-9fe4-5816-b4a4-5057fa6eedb1)
